<!DOCTYPE HTML>
<HTML>

<head>
 <title>Panther</title>
 <META http-equiv=Content-Type content='text/html; charset=utf-8'>
 <SCRIPT src=common.js></SCRIPT>
 <SCRIPT src=wdk.js></SCRIPT>
 <SCRIPT src=product.js></SCRIPT>
 <SCRIPT>
wdk.cdbLoad(['$wan_arpbind_enable', 'route raw', 'arp all']);

var rte = wdk.cdbValA('route raw');
var ate = wdk.cdbValA('arp all');

function init() {
	var f = document.frm;
	var flg, gw, d, k;
	var total1 = rte.length;
	var total2 = ate.length;
	f.reset();
	wdk.init_form();
	for (var i = 0; i < total1; i++) {
		flg = rule2var(rte[i], "flg");
		if (flg == "UG") {
			gw = rule2var(rte[i], "gw");
			break;
		}
	}
	for (var j = 0; j < total2; j++) {
		d = ate[j].split(",");
		k = d[0].split(" ");
		if (k[0] == gw) {
			f.ip.value = k[0];
			f.mac.value = k[2];
			if (d[1] == " PERM\n")
				f.bind.value = "Yes";
			else
				f.bind.value = "No";
		}
	}
}

function apply() {
	wdk.save_form(2000);
}
 </SCRIPT>

 <link rel=stylesheet type=text/css href=demo2.css>
</HEAD>

<body class=gui onload=init() onkeydown="(event.keyCode==13) ? 0 : 1">
 <script>
header()
 </script>
 <form name=frm>
  <fieldset>
   <legend>
    <script>
wdk.putmsg('ARP spoofing correspondence');
    </script>
   </legend>
   <div class=setting>
    <div class=label>
     <script>
wdk.putmsg("Enabled");
     </script>
    </div>
    <input type=checkbox name=wan_arpbind id=$wan_arpbind_enable value=1>
   </div>
   <br>
   <hr>
   <table class=infolist>
    <tr align=center>
     <th>
      <script>
wdk.putmsg("IP Address")
      </script>
     </th>
     <th>
      <script>
wdk.putmsg("MAC Address")
      </script>
     </th>
     <th>
      <script>
wdk.putmsg("Binding")
      </script>
     </th>
    </tr>
    <tr align=center>
     <td>
      <input name=ip disabled size=15>
     </td>
     <td>
      <input name=mac disabled size=17>
     </td>
     <td>
      <input name=bind disabled size=14>
     </td>
    </tr>
   </table>
   <div class=setting align=center>
    <script>
puts('<input type=button class=button valign=center value="' + wdk.msg('Refresh') + '" onclick=refreshPage()>');
    </script>
   </div>
  </fieldset>

  <script>
footer()
  </script>
 </form>

</html>
